overlay: 1.0.0
x-speakeasy-jsonpath: rfc9535
info:
  title: Terraform generation overlay for planetscale_workflow managed and data resources.
  version: 0.0.1
actions:
  - target: $.paths["/organizations/{organization}/databases/{database}/workflows"].post
    description: API operation for managed resource create.
    update:
      x-speakeasy-entity-operation: Workflow#create
      x-speakeasy-entity-description: Manage a PlanetScale database workflow.
  - target: $.paths["/organizations/{organization}/databases/{database}/workflows/{number}"].delete
    description: API operation for managed resource delete.
    update:
      x-speakeasy-entity-operation: Workflow#delete
  - target: $.paths["/organizations/{organization}/databases/{database}/workflows/{number}"].get.parameters[?@.name == 'number'].schema
    description: Fix parameter type to match response property type.
    update:
      type: number
  - target: $.paths["/organizations/{organization}/databases/{database}/workflows/{number}"].delete.parameters[?@.name == 'number'].schema
    description: Fix parameter type to match response property type.
    update:
      type: number
  - target: $.paths["/organizations/{organization}/databases/{database}/workflows/{number}"].get
    description: API operation for data and managed resource read.
    update:
      x-speakeasy-entity-operation:
        - Workflow#read
        - entityOperation: Workflow#create#2
          options:
            polling:
              name: WaitForCompleted
      x-speakeasy-entity-description: Returns information about a PlanetScale database workflow.
      x-speakeasy-polling:
        - name: WaitForCompleted
          limitCount: 300
          successCriteria:
            - condition: $statusCode == 200
            - condition: $response.body#/state == "completed"

  - target: $.paths["/organizations/{organization}/databases/{database}/workflows"].post.responses["201"].content["application/json"].schema.properties
    description: Prevent type mismatch between request and response data
    update:
      global_keyspace:
        x-speakeasy-name-override: global_keyspace_data
      source_keyspace:
        x-speakeasy-name-override: source_keyspace_data
      target_keyspace:
        x-speakeasy-name-override: target_keyspace_data
